{"ast":null,"code":"import { __decorate } from \"tslib\";\nimport { Component } from '@angular/core';\nimport { AnimalWithPhotosDTO } from '../model/animal-with-photos-DTO.model';\nexport let RegisterLostAndFoundComponent = class RegisterLostAndFoundComponent {\n  constructor(lostAndFoundService, photoService, animalService, animalTypeService) {\n    this.lostAndFoundService = lostAndFoundService;\n    this.photoService = photoService;\n    this.animalService = animalService;\n    this.animalTypeService = animalTypeService;\n    this.animal = new AnimalWithPhotosDTO();\n    this.selectedFiles = new Array();\n    this.fileURLs = new Array();\n    this.allAnimalTypes = new Array();\n    this.addAnimalTypeButton = false;\n    this.newType = \"\";\n    this.isAnimalLostOrFound = \"\";\n  }\n  ngOnInit() {\n    console.log(localStorage.getItem('token'));\n    this.readAllAnimalTypes();\n  }\n  getDate() {\n    let date = new Date();\n    let day = date.getDate();\n    let month = date.getMonth() + 1;\n    let year = date.getFullYear();\n    return `${year}-${month < 9 ? '0' + month : month}-${day < 9 ? '0' + day : day}`;\n  }\n  register() {\n    if (this.isInputValid()) {\n      this.selectedFiles.forEach(file => {\n        const formData = new FormData();\n        formData.append('image', file, file.name);\n        console.log(file);\n        this.photoService.uploadMedia(formData).subscribe(response => {\n          console.log(response);\n          // window.location.reload()\n        });\n\n        this.fileURLs.push(file.name);\n        console.log(this.fileURLs);\n      });\n      //!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!REGISTRATION\n      if (this.animal.sterilized == null) {\n        this.animal.sterilized = false;\n      }\n      this.animal.chipNumber = Number(this.animal.chipNumber);\n      this.animal.photos = this.fileURLs;\n      console.log(this.fileURLs);\n      console.log(this.animal);\n      console.log(this.isAnimalLostOrFound);\n      if (this.isAnimalLostOrFound === \"Lost\") {\n        this.lostAndFoundService.registerLost(this.animal).subscribe(response => {\n          console.log(response);\n          alert('Successfully registered');\n          // window.location.href = '/unadopted-animals'\n        }, error => {\n          alert(\"Invalid registration\");\n          console.log(error);\n        });\n      } else if (this.isAnimalLostOrFound === \"Found\") {\n        this.lostAndFoundService.registerFound(this.animal).subscribe(response => {\n          console.log(response);\n          alert('Successfully registered');\n          // window.location.href = '/unadopted-animals'\n        }, error => {\n          alert(\"Invalid registration\");\n          console.log(error);\n        });\n      } else {\n        alert(\"Invalid registration\");\n      }\n    }\n  }\n  isInputValid() {\n    console.log(this.isAnimalLostOrFound);\n    var regexp = /^\\d+$/;\n    // Converting the email to lowercase\n    if (!regexp.test(String(this.animal.chipNumber))) {\n      alert('Chip number must contain only numbers');\n      return false;\n    }\n    if (this.animal.name.trim() == '' || this.animal.animalType.trim() == '' || this.animal.chipNumber == 0 || this.animal.description.trim() == '' || this.animal.gender.trim() == '' || this.animal.location.trim() == '' || this.animal.dateOfBirth == null || this.animal.size.trim() == '' || this.isAnimalLostOrFound.trim() == '') {\n      alert('Please fill in all fields!');\n      return false;\n    }\n    return true;\n  }\n  uploadPhoto(event) {\n    const selectedFiles = event.target.files;\n    console.log(selectedFiles);\n    if (selectedFiles.length > 0) {\n      for (let i = 0; i < selectedFiles.length; i++) {\n        this.selectedFile = event.target.files[i];\n        console.log(this.selectedFile);\n        this.selectedFiles.push(this.selectedFile);\n      }\n    }\n    console.log(this.selectedFiles);\n  }\n  readAllAnimalTypes() {\n    this.animalService.allAnimalTypes().subscribe(response => {\n      console.log(JSON.parse(response));\n      // @ts-ignore\n      JSON.parse(response).forEach(typeObject => {\n        this.allAnimalTypes.push(typeObject.animalType);\n      });\n    });\n  }\n  openAddNewTypeWindow() {\n    this.addAnimalTypeButton = true;\n  }\n  addNewType() {\n    console.log(this.newType);\n    if (this.newType === \"\") {\n      alert(\"You didn't write any new type\");\n    } else {\n      this.animalTypeService.create(this.newType).subscribe(response => {\n        console.log(JSON.parse(response));\n        alert(\"Successfully added new type\");\n        window.location.href = '/register-animal';\n      });\n    }\n  }\n};\nRegisterLostAndFoundComponent = __decorate([Component({\n  selector: 'app-register-lost-and-found',\n  templateUrl: './register-lost-and-found.component.html',\n  styleUrls: ['./register-lost-and-found.component.css']\n})], RegisterLostAndFoundComponent);","map":{"version":3,"names":["Component","AnimalWithPhotosDTO","RegisterLostAndFoundComponent","constructor","lostAndFoundService","photoService","animalService","animalTypeService","animal","selectedFiles","Array","fileURLs","allAnimalTypes","addAnimalTypeButton","newType","isAnimalLostOrFound","ngOnInit","console","log","localStorage","getItem","readAllAnimalTypes","getDate","date","Date","day","month","getMonth","year","getFullYear","register","isInputValid","forEach","file","formData","FormData","append","name","uploadMedia","subscribe","response","push","sterilized","chipNumber","Number","photos","registerLost","alert","error","registerFound","regexp","test","String","trim","animalType","description","gender","location","dateOfBirth","size","uploadPhoto","event","target","files","length","i","selectedFile","JSON","parse","typeObject","openAddNewTypeWindow","addNewType","create","window","href","__decorate","selector","templateUrl","styleUrls"],"sources":["C:\\Users\\vanja\\Desktop\\diplomski\\animalAdoption\\animalAdoptionFrontend\\src\\app\\modules\\register-lost-and-found\\register-lost-and-found.component.ts"],"sourcesContent":["import { Component } from '@angular/core';\nimport { AnimalService } from '../service/animal.service';\nimport { PhotoService } from '../service/photo.service';\nimport { AnimalWithPhotosDTO } from '../model/animal-with-photos-DTO.model';\nimport { AnimalTypeService } from '../service/animalType.service';\nimport { LostAndFoundService } from '../service/lostAndFound.service';\n\n@Component({\n  selector: 'app-register-lost-and-found',\n  templateUrl: './register-lost-and-found.component.html',\n  styleUrls: ['./register-lost-and-found.component.css']\n})\nexport class RegisterLostAndFoundComponent {\n  public animal : AnimalWithPhotosDTO = new AnimalWithPhotosDTO();\n  public selectedFile!: File;\n  public selectedFiles: Array<File> = new Array()\n  public fileURLs : Array<string> = new Array()\n  public allAnimalTypes : Array<String> = new Array()\n  public addAnimalTypeButton: Boolean = false\n  public newType: string = \"\"\n  public isAnimalLostOrFound : string = \"\"\n\n  constructor(private lostAndFoundService: LostAndFoundService, private photoService: PhotoService, private animalService: AnimalService,\n    private animalTypeService: AnimalTypeService) { }\n\n  ngOnInit(): void {\n    console.log(localStorage.getItem('token'));\n    this.readAllAnimalTypes()\n  }\n\n  public getDate(): string {\n    let date = new Date();\n    let day = date.getDate();\n    let month = date.getMonth() + 1;\n    let year = date.getFullYear();\n    return `${year}-${month < 9 ? ('0'+month) : month}-${day < 9 ? ('0'+day) : day}`;\n  }\n\n  register(){\n\n    if(this.isInputValid()){\n\n    this.selectedFiles.forEach(file => {\n      const formData = new FormData();\n\n      formData.append('image', file, file.name)\n    \n      console.log(file) \n    \n      this.photoService.uploadMedia(formData).subscribe(response=>{\n        console.log(response)\n        // window.location.reload()\n\n      })\n        this.fileURLs.push(file.name)\n\n        console.log(this.fileURLs)\n\n\n    });\n    //!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!REGISTRATION\n      if(this.animal.sterilized == null){\n        this.animal.sterilized = false\n      }\n\n      this.animal.chipNumber = Number(this.animal.chipNumber)\n      this.animal.photos = this.fileURLs\n\n      console.log(this.fileURLs)\n      console.log(this.animal)\n      console.log(this.isAnimalLostOrFound)\n      \n      if(this.isAnimalLostOrFound === \"Lost\"){\n        this.lostAndFoundService.registerLost(this.animal).subscribe((response: any) => {\n            console.log(response)\n      \n            alert('Successfully registered');\n      \n            // window.location.href = '/unadopted-animals'\n          },\n          (error) => {\n            alert(\"Invalid registration\");\n            console.log(error);\n          });\n      }\n      else if(this.isAnimalLostOrFound === \"Found\"){\n        this.lostAndFoundService.registerFound(this.animal).subscribe((response: any) => {\n          console.log(response)\n    \n          alert('Successfully registered');\n    \n          // window.location.href = '/unadopted-animals'\n        },\n        (error) => {\n          alert(\"Invalid registration\");\n          console.log(error);\n        });\n      }\n      else{\n        alert(\"Invalid registration\");\n      }\n      }\n    \n\n  }\n\n  \n  public isInputValid(): boolean {\n\n    console.log(this.isAnimalLostOrFound)\n    var regexp = /^\\d+$/     \n    // Converting the email to lowercase\n    if(!regexp.test(String(this.animal.chipNumber))) {\n      alert('Chip number must contain only numbers')\n      return false;\n    }\n\n    if (this.animal.name.trim() == '' || this.animal.animalType.trim() == '' || this.animal.chipNumber == 0\n    || this.animal.description.trim() == ''|| this.animal.gender.trim() == ''|| this.animal.location.trim() == '' \n    || this.animal.dateOfBirth == null || this.animal.size.trim() == '' || this.isAnimalLostOrFound.trim() == '') {\n        alert('Please fill in all fields!');\n        return false;\n     }\n\n     return true;\n  }\n \n  uploadPhoto(event: any) {\n    const selectedFiles: FileList = event.target.files;\n\n    console.log(selectedFiles)\n\n    if (selectedFiles.length > 0) {\n      for (let i = 0; i < selectedFiles.length; i++) {\n        this.selectedFile = <File>event.target.files[i]\n        console.log(this.selectedFile)\n        \n        this.selectedFiles.push(this.selectedFile)\n\n      }\n    }\n\n    console.log(this.selectedFiles)\n  }\n\n  readAllAnimalTypes() {\n\n    this.animalService.allAnimalTypes().subscribe((response: any) => {\n      console.log(JSON.parse(response))\n  \n      // @ts-ignore\n      JSON.parse(response).forEach(typeObject => {\n        \n        this.allAnimalTypes.push(typeObject.animalType)\n      });\n    });\n  }\n\n  openAddNewTypeWindow(){\n    this.addAnimalTypeButton = true;\n  }\n\n  addNewType(){\n    console.log(this.newType)\n    if(this.newType === \"\"){\n      alert(\"You didn't write any new type\")\n    }\n    else{\n      this.animalTypeService.create(this.newType).subscribe((response: any) => {\n        console.log(JSON.parse(response))\n        alert(\"Successfully added new type\")\n\n        window.location.href = '/register-animal'\n    \n      });\n\n    }\n  }\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}