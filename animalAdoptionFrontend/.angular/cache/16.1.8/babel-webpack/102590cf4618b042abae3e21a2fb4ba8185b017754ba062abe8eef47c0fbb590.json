{"ast":null,"code":"import { __decorate } from \"tslib\";\nimport { Component } from '@angular/core';\nimport { AnimalWithPhotosDTO } from '../model/animal-with-photos-DTO.model';\nexport let RegisterAnimalComponent = class RegisterAnimalComponent {\n  constructor(adminService, photoService, animalService, animalTypeService) {\n    this.adminService = adminService;\n    this.photoService = photoService;\n    this.animalService = animalService;\n    this.animalTypeService = animalTypeService;\n    this.animal = new AnimalWithPhotosDTO();\n    this.selectedFiles = new Array();\n    this.fileURLs = new Array();\n    this.allAnimalTypes = new Array();\n    this.addAnimalTypeButton = false;\n    this.newType = \"\";\n  }\n  ngOnInit() {\n    console.log(localStorage.getItem('token'));\n    this.readAllAnimalTypes();\n  }\n  getDate() {\n    let date = new Date();\n    let day = date.getDate();\n    let month = date.getMonth() + 1;\n    let year = date.getFullYear();\n    return `${year}-${month < 9 ? '0' + month : month}-${day < 9 ? '0' + day : day}`;\n  }\n  register() {\n    if (this.isInputValid()) {\n      this.selectedFiles.forEach(file => {\n        const formData = new FormData();\n        formData.append('image', file, file.name);\n        console.log(file);\n        this.photoService.uploadMedia(formData).subscribe(response => {\n          console.log(response);\n          // window.location.reload()\n        });\n\n        this.fileURLs.push(file.name);\n        console.log(this.fileURLs);\n      });\n      //!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!REGISTRATION\n      if (this.animal.sterilized == null) {\n        this.animal.sterilized = false;\n      }\n      this.animal.chipNumber = Number(this.animal.chipNumber);\n      this.animal.photos = this.fileURLs;\n      console.log(this.fileURLs);\n      console.log(this.animal);\n      this.adminService.registerAnimal(this.animal).subscribe(response => {\n        console.log(response);\n        alert('Successfully registered');\n        window.location.href = '/unadopted-animals';\n      }, error => {\n        alert(\"Invalid registration\");\n        console.log(error);\n      });\n    }\n  }\n  isInputValid() {\n    var regexp = /^\\d+$/;\n    // Converting the email to lowercase\n    if (!regexp.test(String(this.animal.chipNumber))) {\n      alert('Chip number must contain only numbers');\n      return false;\n    }\n    if (this.animal.name.trim() == '' || this.animal.animalType.trim() == '' || this.animal.chipNumber == 0 || this.animal.description.trim() == '' || this.animal.gender.trim() == '' || this.animal.location.trim() == '' || this.animal.dateOfBirth == null || this.animal.size.trim() == '') {\n      alert('Please fill in all fields!');\n      return false;\n    }\n    return true;\n  }\n  uploadPhoto(event) {\n    const selectedFiles = event.target.files;\n    console.log(selectedFiles);\n    if (selectedFiles.length > 0) {\n      for (let i = 0; i < selectedFiles.length; i++) {\n        this.selectedFile = event.target.files[i];\n        console.log(this.selectedFile);\n        this.selectedFiles.push(this.selectedFile);\n      }\n    }\n    console.log(this.selectedFiles);\n  }\n  readAllAnimalTypes() {\n    this.animalService.allAnimalTypes().subscribe(response => {\n      console.log(JSON.parse(response));\n      // @ts-ignore\n      JSON.parse(response).forEach(typeObject => {\n        this.allAnimalTypes.push(typeObject.animalType);\n      });\n    });\n  }\n  openAddNewTypeWindow() {\n    this.addAnimalTypeButton = true;\n  }\n  addNewType() {\n    console.log(this.newType);\n    if (this.newType === \"\") {\n      alert(\"You didn't write any new type\");\n    } else {\n      this.animalTypeService.create(this.newType).subscribe(response => {\n        console.log(JSON.parse(response));\n        alert(\"Successfully added new type\");\n        window.location.href = '/register-animal';\n      });\n    }\n  }\n};\nRegisterAnimalComponent = __decorate([Component({\n  selector: 'app-register-animal',\n  templateUrl: './register-animal.component.html',\n  styleUrls: ['./register-animal.component.css']\n})], RegisterAnimalComponent);","map":{"version":3,"names":["Component","AnimalWithPhotosDTO","RegisterAnimalComponent","constructor","adminService","photoService","animalService","animalTypeService","animal","selectedFiles","Array","fileURLs","allAnimalTypes","addAnimalTypeButton","newType","ngOnInit","console","log","localStorage","getItem","readAllAnimalTypes","getDate","date","Date","day","month","getMonth","year","getFullYear","register","isInputValid","forEach","file","formData","FormData","append","name","uploadMedia","subscribe","response","push","sterilized","chipNumber","Number","photos","registerAnimal","alert","window","location","href","error","regexp","test","String","trim","animalType","description","gender","dateOfBirth","size","uploadPhoto","event","target","files","length","i","selectedFile","JSON","parse","typeObject","openAddNewTypeWindow","addNewType","create","__decorate","selector","templateUrl","styleUrls"],"sources":["C:\\Users\\vanja\\Desktop\\diplomski\\animalAdoption\\animalAdoptionFrontend\\src\\app\\modules\\register-animal\\register-animal.component.ts"],"sourcesContent":["import { Component } from '@angular/core';\nimport { AnimalService } from '../service/animal.service';\nimport { AdminService } from '../service/admin.service';\nimport { PhotoService } from '../service/photo.service';\nimport { AnimalWithPhotosDTO } from '../model/animal-with-photos-DTO.model';\nimport { AnimalTypeService } from '../service/animalType.service';\n\n@Component({\n  selector: 'app-register-animal',\n  templateUrl: './register-animal.component.html',\n  styleUrls: ['./register-animal.component.css']\n})\nexport class RegisterAnimalComponent {\n  public animal : AnimalWithPhotosDTO = new AnimalWithPhotosDTO();\n  public selectedFile!: File;\n  public selectedFiles: Array<File> = new Array()\n  public fileURLs : Array<string> = new Array()\n  public allAnimalTypes : Array<String> = new Array()\n  public addAnimalTypeButton: Boolean = false\n  public newType: string = \"\"\n\n  constructor(private adminService: AdminService, private photoService: PhotoService, private animalService: AnimalService,\n    private animalTypeService: AnimalTypeService) { }\n\n  ngOnInit(): void {\n    console.log(localStorage.getItem('token'));\n    this.readAllAnimalTypes()\n  }\n\n  public getDate(): string {\n    let date = new Date();\n    let day = date.getDate();\n    let month = date.getMonth() + 1;\n    let year = date.getFullYear();\n    return `${year}-${month < 9 ? ('0'+month) : month}-${day < 9 ? ('0'+day) : day}`;\n  }\n\n  register(){\n\n    if(this.isInputValid()){\n\n    this.selectedFiles.forEach(file => {\n      const formData = new FormData();\n\n      formData.append('image', file, file.name)\n    \n      console.log(file) \n    \n      this.photoService.uploadMedia(formData).subscribe(response=>{\n        console.log(response)\n        // window.location.reload()\n\n      })\n        this.fileURLs.push(file.name)\n\n        console.log(this.fileURLs)\n\n\n    });\n    //!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!REGISTRATION\n      if(this.animal.sterilized == null){\n        this.animal.sterilized = false\n      }\n\n      this.animal.chipNumber = Number(this.animal.chipNumber)\n      this.animal.photos = this.fileURLs\n\n      console.log(this.fileURLs)\n      console.log(this.animal)\n      \n        this.adminService.registerAnimal(this.animal).subscribe((response: any) => {\n          console.log(response)\n    \n          alert('Successfully registered');\n    \n          window.location.href = '/unadopted-animals'\n        },\n        (error) => {\n          alert(\"Invalid registration\");\n          console.log(error);\n        });\n      }\n\n  }\n\n  \n  public isInputValid(): boolean {\n\n    var regexp = /^\\d+$/     \n    // Converting the email to lowercase\n    if(!regexp.test(String(this.animal.chipNumber))) {\n      alert('Chip number must contain only numbers')\n      return false;\n    }\n\n    if (this.animal.name.trim() == '' || this.animal.animalType.trim() == '' || this.animal.chipNumber == 0\n    || this.animal.description.trim() == ''|| this.animal.gender.trim() == ''|| this.animal.location.trim() == '' \n    || this.animal.dateOfBirth == null|| this.animal.size.trim() == '') {\n        alert('Please fill in all fields!');\n        return false;\n     }\n\n     return true;\n  }\n \n  uploadPhoto(event: any) {\n    const selectedFiles: FileList = event.target.files;\n\n    console.log(selectedFiles)\n\n    if (selectedFiles.length > 0) {\n      for (let i = 0; i < selectedFiles.length; i++) {\n        this.selectedFile = <File>event.target.files[i]\n        console.log(this.selectedFile)\n        \n        this.selectedFiles.push(this.selectedFile)\n\n      }\n    }\n\n    console.log(this.selectedFiles)\n  }\n\n  readAllAnimalTypes() {\n\n    this.animalService.allAnimalTypes().subscribe((response: any) => {\n      console.log(JSON.parse(response))\n  \n      // @ts-ignore\n      JSON.parse(response).forEach(typeObject => {\n        \n        this.allAnimalTypes.push(typeObject.animalType)\n      });\n    });\n  }\n\n  openAddNewTypeWindow(){\n    this.addAnimalTypeButton = true;\n  }\n\n  addNewType(){\n    console.log(this.newType)\n    if(this.newType === \"\"){\n      alert(\"You didn't write any new type\")\n    }\n    else{\n      this.animalTypeService.create(this.newType).subscribe((response: any) => {\n        console.log(JSON.parse(response))\n        alert(\"Successfully added new type\")\n\n        window.location.href = '/register-animal'\n    \n      });\n\n    }\n  }\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}